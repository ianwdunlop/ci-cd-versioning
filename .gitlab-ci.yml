stages:
  - release

default:
  image: ubuntu:18.04

release-common:
  stage: release
  tags:
    - wopr
  script:
    - ./release.sh common
  rules:
    - if: $CI_COMMIT_BRANCH == "master"
      changes:
        - common/*

release-golang:
  stage: release
  tags:
    - wopr
  script:
    - ./release.sh golang
  rules:
    - changes:
        - common/*
      when: never
    - if: $CI_COMMIT_BRANCH == "master"
      changes:
        - golang/*

release-scala:
  stage: release
  tags:
    - wopr
  script:
    - ./release.sh scala --branches
  rules:
    - changes:
        - common/*
      when: never
    - if: $CI_COMMIT_BRANCH == "master"
      changes:
        - scala/*

release-python:
  stage: release
  tags:
    - wopr
  script:
    - ./release.sh python
  rules:
    - changes:
        - common/*
      when: never
    - if: $CI_COMMIT_BRANCH == "master"
      changes:
        - python/*

release-node:
  stage: release
  tags:
    - wopr
  script:
    - ./release.sh node
  rules:
    - changes:
        - common/*
      when: never
    - if: $CI_COMMIT_BRANCH == "master"
      changes:
        - node/*

